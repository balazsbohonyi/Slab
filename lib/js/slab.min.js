(function(){var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=[].slice;d=function(){},b=function(){function b(a,b){this.onButtonClick=e(this.onButtonClick,this),"undefined"!=typeof CompleteMe&&null!==CompleteMe?(this.handleElm(a),this.elm?window.chrome?(this.options=c.extend({},this.defaultOptions,b),this.options=c.extend({},this.options,this),this.options.firstComplete=c.extend({},this.defaultOptions.firstComplete,this.options.firstComplete),this.options.secondComplete=c.extend({},this.defaultOptions.secondComplete,this.options.secondComplete),this.handleTemplate(),this.handleCompleteMe(),this.options.firstComplete.defaultKey&&this.handleDefaultKey(),this.options.firstComplete.selectedKey&&this.setFirstComplete(this.options.firstComplete.selectedKey),this.options.firstComplete.selectedValue&&this.setFirstComplete(this.options.firstComplete.selectedValue),this.options.secondComplete.value&&this.setSecondComplete(this.options.secondComplete.value),this.bindPersistentEvents(),this.handleHooks()):this.handleUnsupportedBrowsers():console.warn("Slab couldn't initialize "+a+" as it's not in the DOM")):console.error("Slab couldn't initialize because the dependency CompleteMe is missing. See https://github.com/callum-hart/Slab for more info.")}return b.prototype.defaultOptions={tabToSearchContent:'Hit <span class="cm-key">tab</span> to search',onSubmit:d,withButton:!1,buttonClass:"sb-button",firstComplete:{placeholder:"",noResultsText:"Can't search by",defaultKey:!1,onFocussed:d,onBlurred:d,onAdd:d,onSelect:d,onNoResults:d,onKeyedUp:d,onKeyedDown:d,onShowSuggestion:d,onClearSuggestion:d,onSuggestionSelected:d},secondComplete:{placeholder:"",noResultsText:"No results match",canAddNewRecordsText:"(Hit enter to search)",onFocussed:d,onBlurred:d,onAdd:d,onSelect:d,onNoResults:d,onKeyedUp:d,onKeyedDown:d,onShowSuggestion:d,onClearSuggestion:d,onSuggestionSelected:d}},b.prototype.version="0.1.1",b.prototype.handleElm=function(a){return"string"==typeof a?this.elm=document.querySelector(a):"object"==typeof a&&a.nodeName?this.elm=a:void 0},b.prototype.bindPersistentEvents=function(){return this.options.withButton?this.buttonElm.addEventListener("click",this.onButtonClick):void 0},b.prototype.onButtonClick=function(a){var b,d,e;return b=null!=(d=c.where("value",this.firstComplete.input.value,this.options.firstComplete.data))?d[0].key:void 0,e=this.secondComplete.input.value,c.present(b)&&c.present(e)?this.handleSubmit(b,e):this.options.firstComplete.defaultKey&&!b?this.handleSubmit(this.options.firstComplete.defaultKey,this.firstComplete.input.value):void 0},b.prototype.handleHooks=function(){return this.firstComplete.options.onFocussed=function(a){return function(){return c.addClass("focussed",a.elm),a.options.firstComplete.onFocussed()}}(this),this.firstComplete.options.onBlurred=function(a){return function(){return c.removeClass("focussed",a.elm),a.options.firstComplete.onBlurred()}}(this),this.firstComplete.options.onAdd=function(a){return function(b){return a.handleSubmit(a.firstComplete.options.defaultKey,b),a.options.firstComplete.onAdd(b)}}(this),this.firstComplete.options.onSelect=function(a){return function(b,c){return a.focusSecondComplete(),a.options.firstComplete.onSelect(b,c)}}(this),this.firstComplete.options.onNoResults=function(a){return function(b){return a.options.firstComplete.onNoResults(b)}}(this),this.firstComplete.options.onKeyedUp=function(a){return function(b){return a.options.firstComplete.onKeyedUp(b)}}(this),this.firstComplete.options.onKeyedDown=function(b){return function(d){return a.isTab(d.keyCode)&&c.present(b.firstComplete.input.value)&&b.firstComplete.input.value===b.firstComplete.suggestionElm.value&&(b.firstComplete.input.value=b.firstComplete.suggestionElm.dataset.result,b.firstComplete.selectedResult=b.firstComplete.resultsElm.querySelector("a.index-0")),a.isTab(d.keyCode)&&b.firstComplete.selectedResult&&(d.preventDefault(),b.firstComplete.input.value=b.firstComplete.selectedResult.dataset.result,b.focusSecondComplete()),b.options.firstComplete.onKeyedDown(d)}}(this),this.firstComplete.options.onShowSuggestion=function(a){return function(b){return a.showTabToSearch(),a.options.firstComplete.onShowSuggestion(b)}}(this),this.firstComplete.options.onClearSuggestion=function(a){return function(){return a.hideTabToSearch(),a.options.firstComplete.onClearSuggestion()}}(this),this.firstComplete.options.onSuggestionSelected=function(a){return function(b,c){return"TAB"===c&&a.focusSecondComplete(),a.options.firstComplete.onSuggestionSelected(b,c)}}(this),this.secondComplete.options.onFocussed=function(a){return function(){return a.onSecondCompleteFocussed(),c.addClass("focussed",a.elm),a.options.secondComplete.onFocussed()}}(this),this.secondComplete.options.onBlurred=function(a){return function(){return c.removeClass("focussed",a.elm),a.options.secondComplete.onBlurred()}}(this),this.secondComplete.options.onAdd=function(a){return function(b){var d;return d=c.where("value",a.firstComplete.input.value,a.options.firstComplete.data)[0].key,a.handleSubmit(d,b),a.secondComplete.hideResults(),a.options.secondComplete.onAdd(b)}}(this),this.secondComplete.options.onSelect=function(a){return function(b){var d;return d=c.where("value",a.firstComplete.input.value,a.options.firstComplete.data)[0].key,a.handleSubmit(d,b),a.secondComplete.hideResults(),a.options.secondComplete.onSelect(b)}}(this),this.secondComplete.options.onNoResults=function(a){return function(b){return a.options.secondComplete.onNoResults(b)}}(this),this.secondComplete.options.onKeyedUp=function(a){return function(b){return a.options.secondComplete.onKeyedUp(b)}}(this),this.secondComplete.options.onKeyedDown=function(b){return function(c){return a.isBackspace(c.keyCode)&&0===b.secondComplete.input.value.length&&(b.hideSelectedLabel(),b.focusFirstComplete()),b.options.secondComplete.onKeyedDown(c)}}(this),this.secondComplete.options.onShowSuggestion=function(a){return function(b){return a.options.secondComplete.onShowSuggestion(b)}}(this),this.secondComplete.options.onClearSuggestion=function(a){return function(){return a.options.secondComplete.onClearSuggestion()}}(this),this.secondComplete.options.onSuggestionSelected=function(a){return function(b,c){return a.options.secondComplete.onSuggestionSelected(b,c)}}(this)},b.prototype.handleCompleteMe=function(){return this.firstComplete=new CompleteMe(this.firstCompleteMeElm,this.options.firstComplete),this.secondComplete=new CompleteMe(this.secondCompleteMeElm,this.options.secondComplete)},b.prototype.focusFirstComplete=function(){return this.firstComplete.input.focus()},b.prototype.focusSecondComplete=function(){return window.requestAnimationFrame(function(a){return function(){return a.showSelectedLabel(a.firstComplete.input.value),a.secondComplete.input.focus()}}(this))},b.prototype.onSecondCompleteFocussed=function(){return 0===this.firstComplete.input.value.length||this.selectedLabelElm.innerText.length>-1?this.focusFirstComplete():void 0},b.prototype.setFirstComplete=function(a){var b;return c.present(a)?(b=c.where("key",a,this.options.firstComplete.data)[0].value,this.firstComplete.setValue(b),this.showSelectedLabel(b)):void 0},b.prototype.setSecondComplete=function(a){return c.present(a)?this.secondComplete.setValue(a):void 0},b.prototype.handleDefaultKey=function(){return this.firstComplete.options.canAddNewRecords=!0},b.prototype.handleSubmit=function(a,b){return this.secondComplete.hideResults(),this.options.onSubmit(a,b)},b.prototype.reset=function(){return this.hideSelectedLabel(),this.firstComplete.setValue(""),this.secondComplete.setValue(""),this.secondComplete.input.blur()},b.prototype.render=function(a,b){return a.innerHTML=b},b.prototype.handleTemplate=function(){return this.containerClass="sb-container",this.autoCompleteClass="sb-complete",this.selectedLabelClass="sb-label",this.tabToSearchClass="sb-tab",this.template='<span class="'+this.selectedLabelClass+'"></span>\n<div class="'+this.autoCompleteClass+' first-complete-me"></div>\n<div class="'+this.autoCompleteClass+' second-complete-me"></div>\n<span class="'+this.tabToSearchClass+'"></span>',this.options.withButton&&(this.buttonSnippet='<button type="button" class="'+this.options.buttonClass+'">\n  <span class="sb-magnify-glass"></span>\n  <span class="sb-magnify-handle"></span>\n</button>',this.template+=this.buttonSnippet),this.render(this.elm,this.template),c.addClass(this.containerClass,this.elm),this.selectedLabelElm=this.elm.querySelector("."+this.selectedLabelClass),this.tabToSearchElm=this.elm.querySelector("."+this.tabToSearchClass),this.buttonElm=this.elm.querySelector("button"),this.firstCompleteMeElm=this.elm.querySelector(".first-complete-me"),this.secondCompleteMeElm=this.elm.querySelector(".second-complete-me")},b.prototype.handleUnsupportedBrowsers=function(){var a;return a='<p class="sb-message">\n  Hey! You caught me a little early. Current browser isn\'t supported yet.\n  <a href="https://github.com/callum-hart/Slab#supported-browsers" target="blank">\n    Check here for updates.\n  </a>\n</p>',this.render(this.elm,a)},b.prototype.showTabToSearch=function(){return c.addClass("tab-showing",this.tabToSearchElm),this.render(this.tabToSearchElm,this.options.tabToSearchContent)},b.prototype.hideTabToSearch=function(){return c.removeClass("tab-showing",this.tabToSearchElm),this.render(this.tabToSearchElm,"")},b.prototype.showSelectedLabel=function(a){return this.render(this.selectedLabelElm,a+":"),c.addClass("label-showing",this.elm)},b.prototype.hideSelectedLabel=function(){return this.render(this.selectedLabelElm,""),c.removeClass("label-showing",this.elm)},b}(),window.Slab=b,c={extend:function(){var a,b,c,d,e,g,h;for(g=arguments[0],e=2<=arguments.length?f.call(arguments,1):[],a=0,c=e.length;c>a;a++){d=e[a];for(b in d)h=d[b],g[b]=h}return g},where:function(a,b,c){var d;return d=[],c.filter(function(c){if("object"==typeof c){if(c[a]===b)return d.push(c)}else if(c===b)return d.push(c)}),d.length>0?d:void 0},addClass:function(a,b){return b.classList.add(a)},removeClass:function(a,b){return b.classList.remove(a)},present:function(a){var b;return"string"==typeof a&&(b=a.length>0),"number"==typeof a&&(b=!0),b}},a={isTab:function(a){return 9===a},isBackspace:function(a){return 8===a}}}).call(this);